{"version":3,"sources":["webpack:///C:/apache/localhost/www/Angular/dynamic-component/src async","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.css","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.html","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/app.module.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.css","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.html","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/html-outlet.directive.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/app/shared/data.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/environments/environment.ts","webpack:///C:/apache/localhost/www/Angular/dynamic-component/src/main.ts"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["function webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"../../../../../src async recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/apache/localhost/www/Angular/dynamic-component/src async\n// module id = ../../../../../src async recursive\n// module chunks = 1","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.css\n// module id = ../../../../../src/app/app.component.css\n// module chunks = 1","module.exports = \"<div style=\\\"text-align: center\\\">\\n  <h1>Тестовое задание</h1>\\n  <p>Typescript/Angular 2</p>\\n  <app-container></app-container>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.html\n// module id = ../../../../../src/app/app.component.html\n// module chunks = 1","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {}\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppComponent } from './app.component';\nimport { ContainerComponent } from './container/container.component';\nimport { HtmlOutletDirective } from './html-outlet.directive';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    ContainerComponent,\n    HtmlOutletDirective\n  ],\n  imports: [\n    BrowserModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/app.module.ts","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"div {\\r\\n    width: 80%;\\r\\n    margin: auto;\\r\\n    margin-top: 10px;\\r\\n    text-align: left;\\r\\n}\\r\\n\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.css\n// module id = ../../../../../src/app/container/container.component.css\n// module chunks = 1","module.exports = \"<div>\\n    <div>\\n        <p>Постановка задачи:</p>\\n        <p>Модель поставляется в json-файле.</p>\\n        <p>\\n            Необходимо разработать компонент который на базе переданной модели создает и загружает в себя angular-компонент, т.е. необходимо в рантайм (после того как angular-приложение уже загрузилось, и была выполнена процедура bootstrap):\\n        </p>\\n        <ol>\\n            <li>\\n              загрузить HTTP-запросом json-файл (путь передается входным параметром компонента);\\n            </li>\\n            <li>\\n              создать корректный HTML-шаблон по загруженной модели;\\n            </li>\\n            <li>\\n              создать angular-компонент с полученным шаблоном и скомпилировать его;\\n            </li>\\n            <li>\\n              загрузить компонент.\\n            </li>\\n        </ol>            \\n    </div>\\n    <div appHtmlOutlet [html]=\\\"dynamicElement\\\">\\n        Здесь будет вставлен динамический компонент:\\n    </div>\\n    <div>\\n        Просьба обратить особое внимание на третий и четвёртый пункт ТЗ. Задание не считается выполненным, если так или иначе используется манипуляция DOM`ом существующего компонента. Т.е компонент должен создаваться директивой Component в runtime (после того, как выполнена процедура bootstrapModule). \\n    </div>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.html\n// module id = ../../../../../src/app/container/container.component.html\n// module chunks = 1","import { Component, OnInit, Renderer2 } from '@angular/core';\n\nimport { HtmlOutletDirective } from '../html-outlet.directive';\nimport { DOMNode, data } from '../shared/data';\n\n@Component({\n  selector: 'app-container',\n  templateUrl: './container.component.html',\n  styleUrls: ['./container.component.css']\n})\nexport class ContainerComponent implements OnInit, DOMNode {\n\n  dynamicElement: string; // html-разметка динамического компонента\n  // Как задать template динамически с помощью Angular 2? Cм. ссылку - https://toster.ru/q/364375\n\n  constructor( private _renderer: Renderer2) { }\n\n  ngOnInit() {\n    // вместо http- запроса просто подгружаем данные\n    const obj: DOMNode = JSON.parse(data);\n    this.dynamicElement = (this.createElement(obj)).outerHTML;\n  }\n\n  // создание html-шаблона\n  createElement( data ) {\n    let element;\n\n    if (data.tag) {\n      element = this._renderer.createElement(data.tag);\n      // console.log(typeof data.tag); // string\n      // console.log(element.toString()); // [object HTMLDivElement]\n    }\n\n    if (data.attributes) {\n      const keys = Object.keys(data.attributes); // возвращает массив строковых элементов, соответствующих именам перечисляемых свойств, найденных непосредственно в самом объекте\n      for (let i = 0; i < keys.length; i++) {\n        this._renderer.setAttribute( element, keys[i], data.attributes[keys[i]]);\n      }\n    }\n\n    if (data.content) {\n      for (let i = 0; i < data.content.length; i++) {\n        if ( data.content[i].text ) {\n          const text = this._renderer.createText(data.content[i].text);\n          this._renderer.appendChild( element, text);\n        } else {\n          const childElement = this.createElement(data.content[i]);\n          this._renderer.appendChild( element, childElement);\n        }\n      }\n    }\n    // console.log(element.outerHTML);\n    return element;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/container/container.component.ts","import {\n  Directive,\n  OnChanges,\n  OnDestroy,\n  NgModule,\n  Component,\n  Input,\n  ComponentRef,\n  Compiler,\n  ViewContainerRef\n} from '@angular/core';\n\nimport { CommonModule } from '@angular/common';\n\n@Directive({\n  selector: '[appHtmlOutlet]'\n})\nexport class HtmlOutletDirective implements  OnChanges, OnDestroy {\n\n  @Input() html: string;\n  cmpRef: ComponentRef<any>;\n\n  constructor(private vcRef: ViewContainerRef, private compiler: Compiler) { }\n\n  ngOnChanges() {\n    const html = this.html;\n    if (!html) { return };\n\n    if (this.cmpRef) {\n      this.cmpRef.destroy();\n    }\n\n    @Component({\n      selector: 'app-dynamic-comp',\n      template: html\n    })\n    class DynamicHtmlComponent  {};\n\n     @NgModule({\n      imports: [CommonModule ],\n      declarations: [DynamicHtmlComponent]\n    })\n    class DynamicHtmlModule {}\n\n    this.compiler.compileModuleAndAllComponentsAsync(DynamicHtmlModule)\n      .then(factory => {\n        const moduleRef = factory.ngModuleFactory.create(this.vcRef.parentInjector);\n\n        const compFactory = factory.componentFactories.find(x => x.componentType === DynamicHtmlComponent);\n        const cmpRef = this.vcRef.createComponent(compFactory, 0, moduleRef.injector);\n      });\n  }\n\n  ngOnDestroy() {\n    if (this.cmpRef) {\n      this.cmpRef.destroy();\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/html-outlet.directive.ts","interface IDomNode {\r\n    tag?: string;\r\n    attributes?: {\r\n      [key: string]: string\r\n    };\r\n    content?: [\r\n      DOMNode | { text?: string; }\r\n    ]\r\n}\r\n\r\nexport class DOMNode implements IDomNode {\r\n    constructor(\r\n      public tag?: string,\r\n      public attributes?: {\r\n        [key: string]: string\r\n      },\r\n      public content?: [\r\n        DOMNode | { text?: string; }\r\n      ]\r\n    ) {}\r\n}\r\n\r\nexport const data: string = '{ \"tag\": \"div\", \"content\": [{ \"tag\": \"span\", \"attributes\":{\"style\": \"color: red\"},\"content\": [{ \"text\": \"Enter value:\" } ]}, {  \"tag\":\"input\", \"attributes\": {\"type\": \"text\", \"value\": \"test\",\t\"style\": \"color: green\"}} ]}';\r\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/app/shared/data.ts","export const environment = {\n  production: true\n};\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/environments/environment.ts","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// C:/apache/localhost/www/Angular/dynamic-component/src/main.ts"],"sourceRoot":""}